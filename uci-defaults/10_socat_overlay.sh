cat <<EOF | sh
echo IyEvYmluL3NoIC9ldGMvcmMuY29tbW9uCiMgQ29weXJpZ2h0IChDKSAyMDIwIExpZW5vbCA8bGF3bGllbm9sQGdtYWlsLmNvbT4KClNUQVJUPTk5CgpDT05GSUc9c29jYXQKQ09ORklHX1BBVEg9L3Zhci9ldGMvJENPTkZJRwoKcnVuX3NlcnZpY2UoKSB7Cgljb25maWdfZ2V0IGVuYWJsZSAkMSBlbmFibGUKCVsgIiRlbmFibGUiID0gIjAiIF0gJiYgcmV0dXJuIDAKCWNvbmZpZ19nZXQgcmVtYXJrcyAkMSByZW1hcmtzCgljb25maWdfZ2V0IHByb3RvY29sICQxIHByb3RvY29sCgljb25maWdfZ2V0IGZhbWlseSAkMSBmYW1pbHkKCWNvbmZpZ19nZXQgcHJvdG8gJDEgcHJvdG8KCWNvbmZpZ19nZXQgbGlzdGVuX3BvcnQgJDEgbGlzdGVuX3BvcnQKCWNvbmZpZ19nZXQgcmV1c2VhZGRyICQxIHJldXNlYWRkcgoJY29uZmlnX2dldCBkZXN0X3Byb3RvICQxIGRlc3RfcHJvdG8KCWNvbmZpZ19nZXQgZGVzdF9pcCAkMSBkZXN0X2lwCgljb25maWdfZ2V0IGRlc3RfcG9ydCAkMSBkZXN0X3BvcnQKCWNvbmZpZ19nZXQgZmlyZXdhbGxfYWNjZXB0ICQxIGZpcmV3YWxsX2FjY2VwdAoJY29uZmlnX2dldCBmaXJld2FsbF9yZWRpcmVjdCAkMSBmaXJld2FsbF9yZWRpcmVjdAoJbG9jYWwgQ09ORklHX0VYRUM9JHtDT05GSUdfUEFUSH0vJDEKCWxuIC1zIC91c3IvYmluL3NvY2F0ICR7Q09ORklHX0VYRUN9CgoJaWYgWyAiJHJldXNlYWRkciIgPT0gIjEiIF07IHRoZW4KCQlyZXVzZWFkZHI9IixyZXVzZWFkZHIiCgllbHNlCgkJcmV1c2VhZGRyPSIiCglmaQoKCWlmIFsgIiRmYW1pbHkiID09ICI2IiBdOyB0aGVuCgkJaXB2Nm9ubHlfcGFyYW1zPSIsaXB2Ni12Nm9ubHkiCgllbHNlCgkJaXB2Nm9ubHlfcGFyYW1zPSIiCglmaQoKCWlzRXJyb3JWZXJzaW9uPSQoc29jYXQgLVYgfCBoZWFkIC01IHwgZ3JlcCAtYyAxLjguMC4wKQoKCWhhbmRsZV9wb3J0X2ZvcndhcmRzKCkgewoJCWlmIFsgIiRwcm90b2NvbCIgPT0gInBvcnRfZm9yd2FyZHMiIF07IHRoZW4KCQkJIyBsaXN0ZW49JHtwcm90b30ke2ZhbWlseX0KCQkJIyBbICIkZmFtaWx5IiA9PSAiIiBdICYmIGxpc3Rlbj0ke3Byb3RvfTYKCQkJIyAke0NPTkZJR19QQVRIfS8kMSAke2xpc3Rlbn0tbGlzdGVuOiR7bGlzdGVuX3BvcnR9JHtpcHY2b25seV9wYXJhbXN9JHtyZXVzZWFkZHJ9LGZvcmsgJHtkZXN0X3Byb3RvfToke2Rlc3RfaXB9OiR7ZGVzdF9wb3J0fSAjPi9kZXYvbnVsbCAyPiYxICYKCQkJbG9jYWwgbGlzdGVuPSR7cHJvdG99JHtmYW1pbHl9CgkJCVsgIiRmYW1pbHkiID09ICIiIF0gJiYgbGlzdGVuPSR7cHJvdG99NgoJCQlzdGFydF9zb2NhdF9wcm9jZXNzKCkgewoJCQkJbG9jYWwgZGVzdF9wcm90bz0ke2Rlc3RfcHJvdG99CgkJCQlpZiBbICIkZGVzdF9wcm90byIgPT0gImF1dG80IiBdOyB0aGVuCgkJCQkJZGVzdF9wcm90bz0ke3Byb3RvfTQKCQkJCWVsaWYgWyAiJGRlc3RfcHJvdG8iID09ICJhdXRvNiIgXTsgdGhlbgoJCQkJCWRlc3RfcHJvdG89JHtwcm90b302CgkJCQlmaQoJCQkJaWYgZWNobyAiJGxpc3Rlbl9wb3J0IiB8IGdyZXAgLXFFICdeWzAtOV0rLVswLTldKyQnOyB0aGVuCgkJCQkJbG9jYWwgc3RhcnRfcG9ydD0kKGVjaG8gIiRsaXN0ZW5fcG9ydCIgfCBjdXQgLWQnLScgLWYxKQoJCQkJCWxvY2FsIGVuZF9wb3J0PSQoZWNobyAiJGxpc3Rlbl9wb3J0IiB8IGN1dCAtZCctJyAtZjIpCgkJCQkJbG9jYWwgZGVzdF9wb3J0X2N1cnJlbnQ9JHtkZXN0X3BvcnR9CgkJCQkJaWYgZWNobyAiJGRlc3RfcG9ydCIgfCBncmVwIC1xRSAnXlswLTldKy1bMC05XSskJzsgdGhlbgoJCQkJCQlkZXN0X3BvcnRfY3VycmVudD0kKGVjaG8gIiRkZXN0X3BvcnQiIHwgY3V0IC1kJy0nIC1mMSkKCQkJCQlmaQoJCQkJCWZvciBsaXN0ZW5fcG9ydF9jdXJyZW50IGluICQoc2VxICIkc3RhcnRfcG9ydCIgIiRlbmRfcG9ydCIpOyBkbwoJCQkJCQllY2hvICR7Q09ORklHX0VYRUN9ICR7bGlzdGVufS1saXN0ZW46JHtsaXN0ZW5fcG9ydF9jdXJyZW50fSR7aXB2Nm9ubHlfcGFyYW1zfSR7cmV1c2VhZGRyfSxmb3JrICR7ZGVzdF9wcm90b306JHtkZXN0X2lwfToke2Rlc3RfcG9ydF9jdXJyZW50fQoJCQkJCQkke0NPTkZJR19FWEVDfSAke2xpc3Rlbn0tbGlzdGVuOiR7bGlzdGVuX3BvcnRfY3VycmVudH0ke2lwdjZvbmx5X3BhcmFtc30ke3JldXNlYWRkcn0sZm9yayAke2Rlc3RfcHJvdG99OiR7ZGVzdF9pcH06JHtkZXN0X3BvcnRfY3VycmVudH0gPi9kZXYvbnVsbCAyPiYxICYKCQkJCQkJZGVzdF9wb3J0X2N1cnJlbnQ9JCgoZGVzdF9wb3J0X2N1cnJlbnQgKyAxKSkKCQkJCQlkb25lCgkJCQllbHNlCgkJCQkJZWNobyAke0NPTkZJR19FWEVDfSAke2xpc3Rlbn0tbGlzdGVuOiR7bGlzdGVuX3BvcnR9JHtpcHY2b25seV9wYXJhbXN9JHtyZXVzZWFkZHJ9LGZvcmsgJHtkZXN0X3Byb3RvfToke2Rlc3RfaXB9OiR7ZGVzdF9wb3J0fQoJCQkJCSR7Q09ORklHX0VYRUN9ICR7bGlzdGVufS1saXN0ZW46JHtsaXN0ZW5fcG9ydH0ke2lwdjZvbmx5X3BhcmFtc30ke3JldXNlYWRkcn0sZm9yayAke2Rlc3RfcHJvdG99OiR7ZGVzdF9pcH06JHtkZXN0X3BvcnR9ID4vZGV2L251bGwgMj4mMSAmCgkJCQlmaQoJCQl9CgoJCQlpZiBbICIkZmFtaWx5IiA9PSAiIiBdOyB0aGVuCgkJCQlpZiBbICIkaXNFcnJvclZlcnNpb24iID09ICIxIiBdOyB0aGVuCgkJCQkJaWYgWyAiJHByb3RvIiA9PSAidWRwIiBdOyB0aGVuCgkJCQkJCWxpc3Rlbj0ke3Byb3RvfTQKCQkJCQkJZWNobyAkcHJvdG8KCQkJCQkJc3RhcnRfc29jYXRfcHJvY2VzcwoJCQkJCQlsaXN0ZW49JHtwcm90b302CgkJCQkJCXN0YXJ0X3NvY2F0X3Byb2Nlc3MKCQkJCQkJcmV0dXJuCgkJCQkJZmkKCQkJCWZpCgkJCWZpCgkJCXN0YXJ0X3NvY2F0X3Byb2Nlc3MKCQlmaQoJfQoKCWhhbmRsZV9maXJld2FsbF9hY2NlcHQoKSB7CgkJaWYgWyAiJGZpcmV3YWxsX2FjY2VwdCIgPT0gIjEiIF07IHRoZW4KCQkJaWYgWyAteiAiJGZhbWlseSIgXTsgdGhlbgoJCQkJYWRkX2ZpcmV3YWxsX3J1bGUgIiRwcm90byIgIiRsaXN0ZW5fcG9ydCIgIiRyZW1hcmtzIiAiIgoJCQllbHNlCgkJCQlpZiBbIC16ICIkZmFtaWx5IiBdIHx8IFsgIiRmYW1pbHkiID09ICI2IiBdOyB0aGVuCgkJCQkJYWRkX2ZpcmV3YWxsX3J1bGUgIiRwcm90byIgIiRsaXN0ZW5fcG9ydCIgIiRyZW1hcmtzIiAiaXB2NiIKCQkJCWZpCgkJCQlpZiBbIC16ICIkZmFtaWx5IiBdIHx8IFsgIiRmYW1pbHkiID09ICI0IiBdOyB0aGVuCgkJCQkJYWRkX2ZpcmV3YWxsX3J1bGUgIiRwcm90byIgIiRsaXN0ZW5fcG9ydCIgIiRyZW1hcmtzIiAiaXB2NCIKCQkJCWZpCgkJCWZpCgkJZmkKCX0KCgloYW5kbGVfZmlyZXdhbGxfYWNjZXB0CglpZiBbICIkZmlyZXdhbGxfcmVkaXJlY3QiICE9ICIwIiBdOyB0aGVuCgkJYWRkX2ZpcmV3YWxsX3JlZGlyZWN0X3J1bGUgIndhbiIgIiRwcm90byIgIiRsaXN0ZW5fcG9ydCIgImxhbiIgIiRkZXN0X2lwIiAiJGRlc3RfcG9ydCIgIiRyZW1hcmtzIiAiJGZhbWlseSIKCWZpCglpZiBbICIkcHJvdG8iID09ICJ0Y3AsdWRwIiBdOyB0aGVuCgkJcHJvdG89InRjcCIKCQloYW5kbGVfcG9ydF9mb3J3YXJkcwoJCXByb3RvPSJ1ZHAiCgkJaGFuZGxlX3BvcnRfZm9yd2FyZHMKCWVsaWYgWyAiJHByb3RvIiA9PSAidGNwIiBdIHx8IFsgIiRwcm90byIgPT0gInVkcCIgXTsgdGhlbgoJCWhhbmRsZV9wb3J0X2ZvcndhcmRzCglmaQp9CgphZGRfZmlyZXdhbGxfcnVsZSgpIHsKCWxvY2FsIHByb3RvPSQxCglsb2NhbCBsaXN0ZW5fcG9ydD0kMgoJbG9jYWwgcmVtYXJrcz0kMwoJbG9jYWwgZmFtaWx5PSQ0Cglsb2NhbCBjdXJyZW50PSQodWNpIGFkZCBmaXJld2FsbCBydWxlKQoJdWNpIHNldCBmaXJld2FsbC4kY3VycmVudC5uYW1lPSJTT0NBVF8ke2xpc3Rlbl9wb3J0fV8ke3Byb3RvfV8ke3JlbWFya3N9IgoJdWNpIHNldCBmaXJld2FsbC4kY3VycmVudC5zcmM9IioiCgl1Y2kgc2V0IGZpcmV3YWxsLiRjdXJyZW50LmRlc3RfcG9ydD0iJGxpc3Rlbl9wb3J0IgoJZm9yIHAgaW4gJChlY2hvICRwcm90byB8IHRyICcsJyAnICcpOyBkbwoJCXVjaSBhZGRfbGlzdCBmaXJld2FsbC4kY3VycmVudC5wcm90bz0iJHAiCglkb25lCgkjIHVjaSBzZXQgZmlyZXdhbGwuJGN1cnJlbnQucHJvdG89IiRwcm90byIKCXVjaSBzZXQgZmlyZXdhbGwuJGN1cnJlbnQudGFyZ2V0PSJBQ0NFUFQiCglbIC1uICIkZmFtaWx5IiBdICYmIHVjaSBzZXQgZmlyZXdhbGwuJGN1cnJlbnQuZmFtaWx5PSIkZmFtaWx5IgoJdWNpIGNvbW1pdCBmaXJld2FsbAp9CmFkZF9maXJld2FsbF9yZWRpcmVjdF9ydWxlKCkgewoJbG9jYWwgc3JjPSQxCglsb2NhbCBwcm90bz0kMgoJbG9jYWwgbGlzdGVuX3BvcnQ9JDMKCWxvY2FsIGRlc3Q9JDQKCWxvY2FsIGRlc3RfaXA9JDUKCWxvY2FsIGRlc3RfcG9ydD0kNgoJbG9jYWwgcmVtYXJrcz0kNwoJbG9jYWwgZmFtaWx5PSQ4CglhZGRfZmlyZXdhbGxfbmF0ICIkc3JjIiAiJHByb3RvIiAiJGxpc3Rlbl9wb3J0IiAiJGRlc3QiICIkZGVzdF9pcCIgIiRkZXN0X3BvcnQiICIkcmVtYXJrcyIgIiRmYW1pbHkiCglsb2NhbCBjdXJyZW50PSQodWNpIGFkZCBmaXJld2FsbCByZWRpcmVjdCkKCXVjaSBzZXQgZmlyZXdhbGwuJGN1cnJlbnQubmFtZT0iU09DQVRfJHtsaXN0ZW5fcG9ydH1fJHtwcm90b31fJHtyZW1hcmtzfSIKCXVjaSBzZXQgZmlyZXdhbGwuJGN1cnJlbnQuc3JjPSIkc3JjIgoJdWNpIHNldCBmaXJld2FsbC4kY3VycmVudC5zcmNfZHBvcnQ9IiRsaXN0ZW5fcG9ydCIKCWZvciBwIGluICQoZWNobyAkcHJvdG8gfCB0ciAnLCcgJyAnKTsgZG8KCQl1Y2kgYWRkX2xpc3QgZmlyZXdhbGwuJGN1cnJlbnQucHJvdG89IiRwIgoJZG9uZQoJdWNpIHNldCBmaXJld2FsbC4kY3VycmVudC5kZXN0PSIkZGVzdCIKCXVjaSBzZXQgZmlyZXdhbGwuJGN1cnJlbnQuZGVzdF9pcD0iJGRlc3RfaXAiCgl1Y2kgc2V0IGZpcmV3YWxsLiRjdXJyZW50LmRlc3RfcG9ydD0iJGRlc3RfcG9ydCIKCXVjaSBzZXQgZmlyZXdhbGwuJGN1cnJlbnQudGFyZ2V0PSJETkFUIgoJWyAtbiAiJGZhbWlseSIgXSAmJiB1Y2kgc2V0IGZpcmV3YWxsLiRjdXJyZW50LmZhbWlseT0iJGZhbWlseSIKCXVjaSBjb21taXQgZmlyZXdhbGwKfQphZGRfZmlyZXdhbGxfbmF0KCkgewoJbG9jYWwgc3JjPSQxCglsb2NhbCBwcm90bz0kMgoJbG9jYWwgbGlzdGVuX3BvcnQ9JDMKCWxvY2FsIGRlc3Q9JDQKCWxvY2FsIGRlc3RfaXA9JDUKCWxvY2FsIGRlc3RfcG9ydD0kNgoJbG9jYWwgcmVtYXJrcz0kNwoJbG9jYWwgZmFtaWx5PSQ4Cglsb2NhbCBjdXJyZW50PSQodWNpIGFkZCBmaXJld2FsbCBuYXQpCgl1Y2kgc2V0IGZpcmV3YWxsLiRjdXJyZW50Lm5hbWU9IlNPQ0FUXyR7bGlzdGVuX3BvcnR9XyR7cHJvdG99XyR7cmVtYXJrc30iCgl1Y2kgc2V0IGZpcmV3YWxsLiRjdXJyZW50LnNyYz0iJGRlc3QiCglmb3IgcCBpbiAkKGVjaG8gJHByb3RvIHwgdHIgJywnICcgJyk7IGRvCgkJdWNpIGFkZF9saXN0IGZpcmV3YWxsLiRjdXJyZW50LnByb3RvPSIkcCIKCWRvbmUKCXVjaSBzZXQgZmlyZXdhbGwuJGN1cnJlbnQuZGVzdF9pcD0iJGRlc3RfaXAiCgl1Y2kgc2V0IGZpcmV3YWxsLiRjdXJyZW50LmRlc3RfcG9ydD0iJGRlc3RfcG9ydCIKCXVjaSBzZXQgZmlyZXdhbGwuJGN1cnJlbnQudGFyZ2V0PSJBQ0NFUFQiCglbIC1uICIkZmFtaWx5IiBdICYmIHVjaSBzZXQgZmlyZXdhbGwuJGN1cnJlbnQuZmFtaWx5PSIkZmFtaWx5IgoJdWNpIGNvbW1pdCBmaXJld2FsbAp9CgpjbGVhcl9maXJld2FsbCgpIHsKCgkjIHJ1bGVzPSgkKHVjaSBzaG93IGZpcmV3YWxsIHwgZ3JlcCAnbmFtZT0nIHwgZ3JlcCAnU09DQVRfJyB8IGN1dCAtZCcuJyAtZjIgfCBjdXQgLWQnPScgLWYxKSkKCWl0ZW1zPSIiCglmb3IgaXRlbSBpbiAkKHVjaSBzaG93IGZpcmV3YWxsIHwgZ3JlcCAnbmFtZT0nIHwgZ3JlcCAnU09DQVRfJyB8IGN1dCAtZCcuJyAtZjIgfCBjdXQgLWQnPScgLWYxKTsgZG8KCQlpdGVtcz0iJGl0ZW0gJGl0ZW1zIgoJZG9uZQoJZm9yIGl0ZW0gaW4gJGl0ZW1zOyBkbwoJCXVjaSBkZWxldGUgImZpcmV3YWxsLiRpdGVtIgoJZG9uZQoJIyBmb3IgcnVsZSBpbiAkKHVjaSBzaG93IGZpcmV3YWxsIHwgZ3JlcCAnbmFtZT0nIHwgZ3JlcCAnU09DQVRfJyB8IGN1dCAtZCcuJyAtZjIgfCBjdXQgLWQnPScgLWYxKTsgZG8KfQoKc3RvcF9zZXJ2aWNlKCkgewoJcHMgLXcgfCBncmVwICIkQ09ORklHX1BBVEgvIiB8IGdyZXAgLXYgImdyZXAiIHwgYXdrICd7cHJpbnQgJDF9JyB8IHhhcmdzIGtpbGwgLTkgPi9kZXYvbnVsbCAyPiYxICYKCSMgZGVsX3J1bGUKCXJtIC1yZiAkQ09ORklHX1BBVEgKCgljbGVhcl9maXJld2FsbAoKCXVjaSBjb21taXQgZmlyZXdhbGwKfQoKc3RhcnQoKSB7CgllbmFibGU9JCh1Y2kgLXEgZ2V0ICRDT05GSUcuQGdsb2JhbFswXS5lbmFibGUpCglpZiBbICIkZW5hYmxlIiA9ICIwIiBdOyB0aGVuCgkJc3RvcF9zZXJ2aWNlCgllbHNlCgkJY2xlYXJfZmlyZXdhbGwKCQlta2RpciAtcCAkQ09ORklHX1BBVEgKCQkjIGFkZF9ydWxlCgkJY29uZmlnX2xvYWQgJENPTkZJRwoJCWNvbmZpZ19mb3JlYWNoIHJ1bl9zZXJ2aWNlICJjb25maWciCgkJIyBnZW5faW5jbHVkZQoJCSMgcmVzdGFydCBmaXJld2FsbAoJCS9ldGMvaW5pdC5kL2ZpcmV3YWxsIHJlbG9hZAoJZmkKfQoKc3RvcCgpIHsKCXN0b3Bfc2VydmljZQp9CgpyZXN0YXJ0KCkgewoJc3RvcAoJc3RhcnQKfQo=|base64 -d > /etc/init.d/socat
chmod +x /etc/init.d/socat

echo wirte /etc/init.d/socat
echo LS0gQ29weXJpZ2h0IDIwMjAgTGllbm9sIDxsYXdsaWVub2xAZ21haWwuY29tPgptb2R1bGUoImx1Y2kuY29udHJvbGxlci5zb2NhdCIsIHBhY2thZ2Uuc2VlYWxsKQpsb2NhbCBodHRwID0gcmVxdWlyZSAibHVjaS5odHRwIgoKZnVuY3Rpb24gaW5kZXgoKQogICAgaWYgbm90IG5peGlvLmZzLmFjY2VzcygiL2V0Yy9jb25maWcvc29jYXQiKSB0aGVuIHJldHVybiBlbmQKCiAgICBlbnRyeSh7ImFkbWluIiwgIm5ldHdvcmsiLCAic29jYXQifSwgY2JpKCJzb2NhdC9pbmRleCIpLCBfKCJTb2NhdCIpLCAxMDApLmFjbF9kZXBlbmRzID0geyAibHVjaS1hcHAtc29jYXQiIH0KICAgIGVudHJ5KHsiYWRtaW4iLCAibmV0d29yayIsICJzb2NhdCIsICJjb25maWcifSwgY2JpKCJzb2NhdC9jb25maWciKSkubGVhZiA9IHRydWUKICAgIGVudHJ5KHsiYWRtaW4iLCAibmV0d29yayIsICJzb2NhdCIsICJzdGF0dXMifSwgY2FsbCgic3RhdHVzIikpLmxlYWYgPSB0cnVlCmVuZAoKZnVuY3Rpb24gc3RhdHVzKCkKICAgIGxvY2FsIGUgPSB7fQogICAgbG9jYWwgaWRzID0gbHVjaS5odHRwLmZvcm12YWx1ZSgiaWRzIikKICAgIGlmIGlkcyB0aGVuCiAgICAgICAgbG9jYWwgcHJvY2VzcyA9IGx1Y2kuc3lzLmV4ZWMoInBzIC13IHwgZ3JlcCAtdiAnZ3JlcCcgfCBncmVwICcvdmFyL2V0Yy9zb2NhdC8nIikKICAgICAgICBmb3IgbGluZSBpbiBwcm9jZXNzOmdtYXRjaCgiW15cclxuXSsiKSBkbwogICAgICAgICAgICBmb3IgaWQgaW4gaWRzOmdtYXRjaCgiWyV3JS1dKyIpIGRvCiAgICAgICAgICAgICAgICBpZiBsaW5lOm1hdGNoKGlkKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgZVtpZF0gPSBlW2lkXSBhbmQgZVtpZF0gKyAxIG9yIDEKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAogICAgaHR0cC53cml0ZV9qc29uKGUpCmVuZAo=|base64 -d > /usr/lib/lua/luci/controller/socat.lua

echo wirte /usr/lib/lua/luci/controller/socat.lua
echo CWxvY2FsIGQgPSByZXF1aXJlICJsdWNpLmRpc3BhdGNoZXIiCgptID0gTWFwKCJzb2NhdCIsIHRyYW5zbGF0ZSgiU29jYXQgQ29uZmlnIikpCm0ucmVkaXJlY3QgPSBkLmJ1aWxkX3VybCgiYWRtaW4iLCAibmV0d29yayIsICJzb2NhdCIpCgpzID0gbTpzZWN0aW9uKE5hbWVkU2VjdGlvbiwgYXJnWzFdLCAiY29uZmlnIiwgIiIpCnMuYWRkcmVtb3ZlID0gZmFsc2UKcy5keW5hbWljID0gZmFsc2UKCm8gPSBzOm9wdGlvbihGbGFnLCAiZW5hYmxlIiwgdHJhbnNsYXRlKCJFbmFibGUiKSkKby5kZWZhdWx0ID0gIjEiCm8ucm1lbXB0eSA9IGZhbHNlCgpvID0gczpvcHRpb24oVmFsdWUsICJyZW1hcmtzIiwgdHJhbnNsYXRlKCJSZW1hcmtzIikpCm8uZGVmYXVsdCA9IHRyYW5zbGF0ZSgiUmVtYXJrcyIpCm8ucm1lbXB0eSA9IGZhbHNlCgpvID0gczpvcHRpb24oTGlzdFZhbHVlLCAicHJvdG9jb2wiLCB0cmFuc2xhdGUoIlByb3RvY29sIikpCm86dmFsdWUoInBvcnRfZm9yd2FyZHMiLCB0cmFuc2xhdGUoIlBvcnQgRm9yd2FyZHMiKSkKLS0gbzp2YWx1ZSgiZmlyZXdhbGxfZm9yd2FyZHMiLCB0cmFuc2xhdGUoIuS7hemYsueBq+Wimei9rOWPkSIpKQoKCm8gPSBzOm9wdGlvbihMaXN0VmFsdWUsICJmYW1pbHkiLCB0cmFuc2xhdGUoIlJlc3RyaWN0IHRvIGFkZHJlc3MgZmFtaWx5IikpCm86dmFsdWUoIiIsIHRyYW5zbGF0ZSgiSVB2NCBhbmQgSVB2NiIpKQpvOnZhbHVlKCI0IiwgdHJhbnNsYXRlKCJJUHY0IG9ubHkiKSkKbzp2YWx1ZSgiNiIsIHRyYW5zbGF0ZSgiSVB2NiBvbmx5IikpCm86ZGVwZW5kcygicHJvdG9jb2wiLCAicG9ydF9mb3J3YXJkcyIpCgpvID0gczpvcHRpb24oTGlzdFZhbHVlLCAicHJvdG8iLCB0cmFuc2xhdGUoIlByb3RvY29sIikpCm86dmFsdWUoInRjcCx1ZHAiLCAiVENQK1VEUCIpCm86dmFsdWUoInRjcCIsICJUQ1AiKQpvOnZhbHVlKCJ1ZHAiLCAiVURQIikKbzpkZXBlbmRzKCJwcm90b2NvbCIsICJwb3J0X2ZvcndhcmRzIikKCm8gPSBzOm9wdGlvbihWYWx1ZSwgImxpc3Rlbl9wb3J0IiwgdHJhbnNsYXRlKCJMaXN0ZW4gcG9ydCIpKQpvLmRhdGF0eXBlID0gInBvcnRyYW5nZSIKby5ybWVtcHR5ID0gZmFsc2UKbzpkZXBlbmRzKCJwcm90b2NvbCIsICJwb3J0X2ZvcndhcmRzIikKCm8gPSBzOm9wdGlvbihGbGFnLCAicmV1c2VhZGRyIiwgInJldXNlYWRkciIsIHRyYW5zbGF0ZSgiQmluZCB0byBhIHBvcnQgbG9jYWwiKSkKby5kZWZhdWx0ID0gIjEiCm8ucm1lbXB0eSA9IGZhbHNlCgpvID0gczpvcHRpb24oTGlzdFZhbHVlLCAiZGVzdF9wcm90byIsIHRyYW5zbGF0ZSgiRGVzdGluYXRpb24gUHJvdG9jb2wiKSkKbzp2YWx1ZSgiYXV0bzQiLCAiSVB2NC3pu5jorqQiKQpvOnZhbHVlKCJhdXRvNiIsICJJUHY2Lem7mOiupCIpCm86dmFsdWUoInRjcDQiLCAiSVB2NC1UQ1AiKQpvOnZhbHVlKCJ1ZHA0IiwgIklQdjQtVURQIikKbzp2YWx1ZSgidGNwNiIsICJJUHY2LVRDUCIpCm86dmFsdWUoInVkcDYiLCAiSVB2Ni1VRFAiKQotLSBvOmRlcGVuZHMoInByb3RvIiwgInRjcCx1ZHAiKQotLSBvOmRlcGVuZHMoInByb3RvY29sIiwgInBvcnRfZm9yd2FyZHMiKQoKZGVzdF9pcHY0ID0gczpvcHRpb24oVmFsdWUsICJkZXN0X2lwdjQiLCB0cmFuc2xhdGUoIkRlc3RpbmF0aW9uIGFkZHJlc3MiKSkKbHVjaS5zeXMubmV0LmlwdjRfaGludHMoZnVuY3Rpb24oaXAsIG5hbWUpCglkZXN0X2lwdjQ6dmFsdWUoaXAsICIlcyAoJXMpIiAleyBpcCwgbmFtZSB9KQplbmQpCmZ1bmN0aW9uIGRlc3RfaXB2NC5jZmd2YWx1ZShzZWxmLCBzZWN0aW9uKQoJcmV0dXJuIG06Z2V0KHNlY3Rpb24sICJkZXN0X2lwIikKZW5kCmZ1bmN0aW9uIGRlc3RfaXB2NC53cml0ZShzZWxmLCBzZWN0aW9uLCB2YWx1ZSkKCW06c2V0KHNlY3Rpb24sICJkZXN0X2lwIiwgdmFsdWUpCmVuZApkZXN0X2lwdjQ6ZGVwZW5kcygiZGVzdF9wcm90byIsICJhdXRvNCIpCmRlc3RfaXB2NDpkZXBlbmRzKCJkZXN0X3Byb3RvIiwgInRjcDQiKQpkZXN0X2lwdjQ6ZGVwZW5kcygiZGVzdF9wcm90byIsICJ1ZHA0IikKCmRlc3RfaXB2NiA9IHM6b3B0aW9uKFZhbHVlLCAiZGVzdF9pcHY2IiwgdHJhbnNsYXRlKCJEZXN0aW5hdGlvbiBhZGRyZXNzIikpCmx1Y2kuc3lzLm5ldC5pcHY2X2hpbnRzKGZ1bmN0aW9uKGlwLCBuYW1lKQoJZGVzdF9pcHY2OnZhbHVlKGlwLCAiJXMgKCVzKSIgJXsgaXAsIG5hbWUgfSkKZW5kKQpmdW5jdGlvbiBkZXN0X2lwdjYuY2ZndmFsdWUoc2VsZiwgc2VjdGlvbikKCXJldHVybiBtOmdldChzZWN0aW9uLCAiZGVzdF9pcCIpCmVuZApmdW5jdGlvbiBkZXN0X2lwdjYud3JpdGUoc2VsZiwgc2VjdGlvbiwgdmFsdWUpCgltOnNldChzZWN0aW9uLCAiZGVzdF9pcCIsIHZhbHVlKQplbmQKZGVzdF9pcHY2OmRlcGVuZHMoImRlc3RfcHJvdG8iLCAiYXV0bzYiKQpkZXN0X2lwdjY6ZGVwZW5kcygiZGVzdF9wcm90byIsICJ0Y3A2IikKZGVzdF9pcHY2OmRlcGVuZHMoImRlc3RfcHJvdG8iLCAidWRwNiIpCgpvID0gczpvcHRpb24oVmFsdWUsICJkZXN0X3BvcnQiLCB0cmFuc2xhdGUoIkRlc3RpbmF0aW9uIHBvcnQiKSkKby5kYXRhdHlwZSA9ICJwb3J0cmFuZ2UiCm8ucm1lbXB0eSA9IGZhbHNlCgpvID0gczpvcHRpb24oRmxhZywgImZpcmV3YWxsX2FjY2VwdCIsIHRyYW5zbGF0ZSgiT3BlbiBmaXJld2FsbCBwb3J0IikpCm8uZGVmYXVsdCA9ICIxIgpvLnJtZW1wdHkgPSBmYWxzZQoKbyA9IHM6b3B0aW9uKEZsYWcsICJmaXJld2FsbF9yZWRpcmVjdCIsIHRyYW5zbGF0ZSgi5re75Yqg6Ziy54Gr5aKZ6L2s5Y+RIikpCm8uZGVmYXVsdCA9ICIxIgpvLnJtZW1wdHkgPSBmYWxzZQoKcmV0dXJuIG0K|base64 -d > /usr/lib/lua/luci/model/cbi/socat/config.lua

echo wirte /usr/lib/lua/luci/model/cbi/socat/config.lua
echo bG9jYWwgZCA9IHJlcXVpcmUgImx1Y2kuZGlzcGF0Y2hlciIKbG9jYWwgZSA9IGx1Y2kubW9kZWwudWNpLmN1cnNvcigpCgptID0gTWFwKCJzb2NhdCIsIHRyYW5zbGF0ZSgiU29jYXQiKSwgdHJhbnNsYXRlKCJTb2NhdCBpcyBhIHZlcnNhdGlsZSBuZXR3b3JraW5nIHRvb2wgbmFtZWQgYWZ0ZXIgJ1NvY2tldCBDQVQnLCB3aGljaCBjYW4gYmUgcmVnYXJkZWQgYXMgYW4gTi1mb2xkIGVuaGFuY2VkIHZlcnNpb24gb2YgTmV0Q2F0IikpCgpzID0gbTpzZWN0aW9uKE5hbWVkU2VjdGlvbiwgImdsb2JhbCIsICJnbG9iYWwiKQpzLmFub255bW91cyA9IHRydWUKcy5hZGRyZW1vdmUgPSBmYWxzZQoKbyA9IHM6b3B0aW9uKEZsYWcsICJlbmFibGUiLCB0cmFuc2xhdGUoIkVuYWJsZSIpKQpvLnJtZW1wdHkgPSBmYWxzZQoKcyA9IG06c2VjdGlvbihUeXBlZFNlY3Rpb24sICJjb25maWciLCB0cmFuc2xhdGUoIlBvcnQgRm9yd2FyZHMiKSkKcy5hbm9ueW1vdXMgPSB0cnVlCnMuYWRkcmVtb3ZlID0gdHJ1ZQpzLnRlbXBsYXRlID0gImNiaS90YmxzZWN0aW9uIgpzLmV4dGVkaXQgPSBkLmJ1aWxkX3VybCgiYWRtaW4iLCAibmV0d29yayIsICJzb2NhdCIsICJjb25maWciLCAiJXMiKQpmdW5jdGlvbiBzLmZpbHRlcihlLCB0KQogICAgaWYgbTpnZXQodCwgInByb3RvY29sIikgPT0gInBvcnRfZm9yd2FyZHMiIHRoZW4KICAgICAgICByZXR1cm4gdHJ1ZQogICAgZW5kCmVuZApmdW5jdGlvbiBzLmNyZWF0ZShlLCB0KQogICAgbG9jYWwgdXVpZCA9IHN0cmluZy5nc3ViKGx1Y2kuc3lzLmV4ZWMoImVjaG8gLW4gJChjYXQgL3Byb2Mvc3lzL2tlcm5lbC9yYW5kb20vdXVpZCkiKSwgIi0iLCAiIikKICAgIHQgPSB1dWlkCiAgICBUeXBlZFNlY3Rpb24uY3JlYXRlKGUsIHQpCiAgICBsdWNpLmh0dHAucmVkaXJlY3QoZS5leHRlZGl0OmZvcm1hdCh0KSkKZW5kCmZ1bmN0aW9uIHMucmVtb3ZlKGUsIHQpCiAgICBlLm1hcC5wcm9jZWVkID0gdHJ1ZQogICAgZS5tYXA6ZGVsKHQpCiAgICBsdWNpLmh0dHAucmVkaXJlY3QoZC5idWlsZF91cmwoImFkbWluIiwgIm5ldHdvcmsiLCAic29jYXQiKSkKZW5kCgpvID0gczpvcHRpb24oRmxhZywgImVuYWJsZSIsIHRyYW5zbGF0ZSgiRW5hYmxlIikpCm8ud2lkdGggPSAiNSUiCm8ucm1lbXB0eSA9IGZhbHNlCgpvID0gczpvcHRpb24oRHVtbXlWYWx1ZSwgInN0YXR1cyIsIHRyYW5zbGF0ZSgiU3RhdHVzIikpCm8udGVtcGxhdGUgPSAic29jYXQvc3RhdHVzIgpvLnZhbHVlID0gdHJhbnNsYXRlKCJDb2xsZWN0aW5nIGRhdGEuLi4iKQoKbyA9IHM6b3B0aW9uKER1bW15VmFsdWUsICJyZW1hcmtzIiwgdHJhbnNsYXRlKCJSZW1hcmtzIikpCgpvID0gczpvcHRpb24oRHVtbXlWYWx1ZSwgImZhbWlseSIsIHRyYW5zbGF0ZSgiTGlzdGVuIFByb3RvY29sIikpCm8uY2ZndmFsdWUgPSBmdW5jdGlvbih0LCBuKQogICAgbG9jYWwgbGlzdGVuID0gVmFsdWUuY2ZndmFsdWUodCwgbikgb3IgIiIKICAgIGxvY2FsIHByb3RvY29sID0gKG06Z2V0KG4sICJwcm90byIpIG9yICIiKTp1cHBlcigpCiAgICBpZiBsaXN0ZW4gPT0gIiIgdGhlbgogICAgICAgIHJldHVybiBwcm90b2NvbAogICAgZWxzZQogICAgICAgIHJldHVybiAiSVB2IiAuLiBsaXN0ZW4gLi4gIi0iIC4uIHByb3RvY29sCiAgICBlbmQKZW5kCgpvID0gczpvcHRpb24oRHVtbXlWYWx1ZSwgImxpc3Rlbl9wb3J0IiwgdHJhbnNsYXRlKCJMaXN0ZW4gcG9ydCIpKQoKbyA9IHM6b3B0aW9uKER1bW15VmFsdWUsICJkZXN0X3Byb3RvIiwgdHJhbnNsYXRlKCJEZXN0aW5hdGlvbiBQcm90b2NvbCIpKQpvLmNmZ3ZhbHVlID0gZnVuY3Rpb24odCwgbikKICAgIGxvY2FsIGxpc3RlbiA9IFZhbHVlLmNmZ3ZhbHVlKHQsIG4pCiAgICBsb2NhbCBwcm90b2NvbCA9IGxpc3RlbjpzdWIoMCwgI2xpc3RlbiAtIDEpOnVwcGVyKCkKICAgIGxvY2FsIGlwX3R5cGUgPSAiSVB2IiAuLiBsaXN0ZW46c3ViKCNsaXN0ZW4pCiAgICByZXR1cm4gaXBfdHlwZSAuLiAiLSIgLi4gcHJvdG9jb2wKZW5kCgpvID0gczpvcHRpb24oRHVtbXlWYWx1ZSwgImRlc3RfaXAiLCB0cmFuc2xhdGUoIkRlc3RpbmF0aW9uIGFkZHJlc3MiKSkKCm8gPSBzOm9wdGlvbihEdW1teVZhbHVlLCAiZGVzdF9wb3J0IiwgdHJhbnNsYXRlKCJEZXN0aW5hdGlvbiBwb3J0IikpCgpvID0gczpvcHRpb24oRmxhZywgImZpcmV3YWxsX2FjY2VwdCIsIHRyYW5zbGF0ZSgiT3BlbiBmaXJld2FsbCBwb3J0IikpCm8uZGVmYXVsdCA9ICIxIgpvLnJtZW1wdHkgPSBmYWxzZQoKbyA9IHM6b3B0aW9uKEZsYWcsICJmaXJld2FsbF9yZWRpcmVjdCIsIHRyYW5zbGF0ZSgi5re75Yqg6Ziy54Gr5aKZ6L2s5Y+RIikpCm8uZGVmYXVsdCA9ICIxIgpvLnJtZW1wdHkgPSBmYWxzZQoKbTphcHBlbmQoVGVtcGxhdGUoInNvY2F0L2xpc3Rfc3RhdHVzIikpCnJldHVybiBtCgo=|base64 -d > /usr/lib/lua/luci/model/cbi/socat/index.lua

echo wirte /usr/lib/lua/luci/model/cbi/socat/index.lua
echo PHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPgoJLy88IVtDREFUQVsKCWNvbnN0IF9zdGF0dXMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdfc3RhdHVzJyk7CglsZXQgaWRzID0gIiIKCWZvciAobGV0IGkgPSAwOyBpIDwgX3N0YXR1cy5sZW5ndGg7IGkrKykgewoJCWNvbnN0IGVsZW1lbnQgPSBfc3RhdHVzW2ldOwoJCWNvbnN0IHBhcmVudElkID0gZWxlbWVudC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5pZDsKCQlpZHMgKz0gcGFyZW50SWQuc3Vic3RyKHBhcmVudElkLmxhc3RJbmRleE9mKCItIikgKyAxKSArICIsIjsKCX0KCXNldEludGVydmFsKCgpID0+IHsKCQlYSFIucG9zdCgnPCU9dXJsKFtbYWRtaW5dXSwgW1tuZXR3b3JrXV0sIFtbc29jYXRdXSwgW1tzdGF0dXNdXSklPicsIHsKCQkJaWRzOiBpZHMKCQl9LAoJCQlmdW5jdGlvbiAoeCkgewoJCQkJY29uc3QgcmVzdWx0ID0gSlNPTi5wYXJzZSh4LnJlc3BvbnNlVGV4dCk7CgkJCQlmb3IgKGxldCBpID0gMDsgaSA8IF9zdGF0dXMubGVuZ3RoOyBpKyspIHsKCQkJCQljb25zdCBlbGVtZW50ID0gX3N0YXR1c1tpXTsKCQkJCQljb25zdCBwYXJlbnRJZCA9IGVsZW1lbnQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuaWQ7CgkJCQkJY29uc3QgaWQgPSBwYXJlbnRJZC5zdWJzdHIocGFyZW50SWQubGFzdEluZGV4T2YoIi0iKSArIDEpOwoJCQkJCWxldCBjb3VudCA9IHJlc3VsdFtpZF0KCQkJCQlpZiAoY291bnQgPT09IHVuZGVmaW5lZCkgY291bnQgPSAwCgkJCQkJZWxlbWVudC5zZXRBdHRyaWJ1dGUoInN0eWxlIiwgImZvbnQtd2VpZ2h0OmJvbGQ7Iik7CgkJCQkJZWxlbWVudC5zZXRBdHRyaWJ1dGUoImNvbG9yIiwgY291bnQgPiAwID8gImdyZWVuIiA6ICJyZWQiKTsKCQkJCQllbGVtZW50LmlubmVySFRNTCA9IChjb3VudCA+IDAgPyAn4pyTJyArCgkJCQkJCShjb3VudCA+IDEgPyAnICcgKyBjb3VudCA6ICcnKQoJCQkJCQk6ICdYJyk7CgkJCQl9CgkJCX0KCQkpOwoJfSwgMjAwMCk7CgkvL11dPgo8L3NjcmlwdD4=|base64 -d > /usr/lib/lua/luci/view/socat/list_status.htm

echo wirte /usr/lib/lua/luci/view/socat/list_status.htm
echo PCUrY2JpL3ZhbHVlaGVhZGVyJT4KPGZvbnQgY2xhc3M9Il9zdGF0dXMiIGhpbnQ9IjwlPXNlbGY6Y2ZndmFsdWUoc2VjdGlvbiklPiI+LS08L2ZvbnQ+CjwlK2NiaS92YWx1ZWZvb3RlciU+|base64 -d > /usr/lib/lua/luci/view/socat/status.htm

echo wirte /usr/lib/lua/luci/view/socat/status.htm
EOF
